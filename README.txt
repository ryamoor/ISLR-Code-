This code is not mine but is from the book/videos Introduction of Staistical Learning  by Gareth James, Daniela Witten, Trevor Hastie, and Robert Tibshirani.
These instructional videos have been instrumental to my understanding of the machine learning landscape.

https://www.r-bloggers.com/in-depth-introduction-to-machine-learning-in-15-hours-of-expert-videos/